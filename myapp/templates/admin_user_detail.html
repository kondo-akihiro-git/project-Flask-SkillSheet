{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <div class="buttons mb-4">
        <a class="button is-link" href="{{ url_for('admin_login') }}">ログイン画面に戻る</a>
        <a class="button is-link" href="{{ url_for('admin_dashboard') }}">ダッシュボードに戻る</a>
        <a class="button is-link" href="{{ url_for('admin_users') }}">ユーザー一覧に戻る</a>
    </div>
    <h1 class="title">ユーザー詳細</h1>
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    {% set category, message = messages[messages|length-1] %}
    <div class="notification is-{{ category }}">
        {{ message }}
    </div>
    {% endif %}
    {% endwith %}
    <div class="box">
        <form action="{{ url_for('admin_user_detail', user_id=user.id) }}" method="post">
            <div class="field">
                <label class="label">ID</label>
                <div class="control">
                    <p class="is-size-5">{{ user.id }}</p>
                </div>
            </div>
            <div class="field">
                <label class="label">ユーザー名</label>
                <div class="control">
                    <input class="input" type="text" name="username" value="{{ user.username or '' }}">
                </div>
            </div>
            <div class="field">
                <label class="label">表示名</label>
                <div class="control">
                    <input class="input" type="text" name="display_name" value="{{ user.display_name or '' }}">
                </div>
            </div>
            <div class="field">
                <label class="label">メールアドレス</label>
                <div class="control">
                    <input class="input" type="email" name="email" value="{{ user.email or '' }}">
                </div>
            </div>
            <div class="field">
                <label class="label">年齢</label>
                <div class="control">
                    <input class="input" type="number" name="age" value="{{ user.age or '' }}">
                </div>
            </div>
            <div class="field">
                <label class="label">性別</label>
                <div class="control">
                    <input class="input" type="text" name="gender" value="{{ user.gender or '' }}">
                </div>
            </div>
            <div class="field">
                <label class="label">最寄り駅</label>
                <div class="control">
                    <input class="input" type="text" name="nearest_station" value="{{ user.nearest_station or '' }}">
                </div>
            </div>
            <div class="field">
                <label class="label">経験年数</label>
                <div class="control">
                    <input class="input" type="number" name="experience_years" value="{{ user.experience_years or '' }}">
                </div>
            </div>
            <div class="field">
                <label class="label">学歴</label>
                <div class="control">
                    <input class="input" type="text" name="education" value="{{ user.education or '' }}">
                </div>
            </div>
            <div class="field">
                <label class="label">管理者</label>
                <div class="control">
                    <input class="checkbox" type="checkbox" name="is_admin" value="true" {% if user.is_admin %}checked{% endif %}>
                </div>
            </div>
            <div class="field">
                <div class="control">
                    <button class="button is-primary" type="submit">保存</button>
                </div>
            </div>
        </form>
    </div>
    {% if latest_active_url %}
        <div class="notification is-info mt-5">
            <p>最新の有効なスキルシートのリンク: <a href="{{ latest_active_url }}">{{ latest_active_url }}</a></p>
        </div>
    {% else %}
        <div class="notification is-warning mt-5">
            <p>有効なスキルシートのリンクはありません。</p>
        </div>
    {% endif %}
    <a class="button is-link mt-5" href="{{ url_for('admin_users') }}">戻る</a>
</div>
{% endblock %}
